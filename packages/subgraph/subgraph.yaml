specVersion: 0.0.4
description: AI Vault Protocol Subgraph
repository: https://github.com/scaffold-eth/se-2/packages/subgraph/
schema:
  file: ./src/schema.graphql
dataSources:
  - kind: ethereum/contract
    name: VaultFactory
    network: localhost
    source:
      abi: VaultFactory
      address: "0xed1db453c3156ff3155a97ad217b3087d5dc5f6e"
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - VaultFactory
        - Vault
        - Asset
        - VaultManager
      abis:
        - name: VaultFactory
          file: ./abis/localhost_VaultFactory.json
        - name: IERC20Metadata
          file: ./abis/IERC20Metadata.json
        - name: AIAgentVaultManager
          file: ./abis/localhost_AIAgentVaultManager.json
      eventHandlers:
        - event: VaultCreated(indexed address,indexed address,indexed
            address,string,string,uint256)
          handler: handleVaultCreated
      file: ./src/mappings/VaultFactory.ts
  - kind: ethereum/contract
    name: AIAgentVaultManager
    network: localhost
    source:
      abi: AIAgentVaultManager
      address: "0xe1da8919f262ee86f9be05059c9280142cf23f48"
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - VaultManager
        - Vault
        - Allocation
        - AaveAdapter
        - UniswapV2Adapter
        - UniswapV3Adapter
      abis:
        - name: AIAgentVaultManager
          file: ./abis/localhost_AIAgentVaultManager.json
      eventHandlers:
        - event: VaultCreatedAndRegistered(indexed address,string)
          handler: handleVaultCreatedAndRegistered
        - event: AdapterAddedToList(indexed address,string)
          handler: handleAdapterAddedToList
      file: ./src/mappings/AIAgentVaultManager.ts
  - kind: ethereum/contract
    name: VaultImplementation
    network: localhost
    source:
      abi: VaultImplementation
      address: "0x0c8e79f3534b00d9a3d4a856b665bf4ebc22f2ba"
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Vault
        - User
        - Deposit
        - Redeem
        - Allocation
        - UserVaultBalance
      abis:
        - name: VaultImplementation
          file: ./abis/localhost_VaultImplementation.json
        - name: IProtocolAdapter
          file: ./abis/IProtocolAdapter.json
      eventHandlers:
        - event: Deposit(uint256,indexed address,uint256)
          handler: handleDeposit
        - event: Redeem(uint256,indexed address,uint256)
          handler: handleRedeem
        - event: NoLongerActive()
          handler: handleNoLongerActive
        - event: HoldingAllocationUpdated((address,uint256)[])
          handler: handleHoldingAllocationUpdated
      file: ./src/mappings/VaultImplementation.ts
  - kind: ethereum/contract
    name: VaultSharesETH
    network: localhost
    source:
      abi: VaultSharesETH
      address: "0xf1078fd568ad76e49e6f88d1ff485402a086976b"
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Vault
        - User
        - Deposit
        - Redeem
        - Allocation
        - UserVaultBalance
      abis:
        - name: VaultSharesETH
          file: ./abis/localhost_VaultSharesETH.json
        - name: IProtocolAdapter
          file: ./abis/IProtocolAdapter.json
      eventHandlers:
        - event: Deposit(uint256,indexed address,uint256)
          handler: handleDeposit
        - event: Redeem(uint256,indexed address,uint256)
          handler: handleRedeem
        - event: NoLongerActive()
          handler: handleNoLongerActive
        - event: HoldingAllocationUpdated((address,uint256)[])
          handler: handleHoldingAllocationUpdated
      file: ./src/mappings/VaultSharesETH.ts
  - kind: ethereum/contract
    name: AaveAdapter
    network: localhost
    source:
      abi: AaveAdapter
      address: "0xf56aa3aceddf88ab12e494d0b96da3c09a5d264e"
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - AaveAdapter
        - AaveTokenPosition
      abis:
        - name: AaveAdapter
          file: ./abis/localhost_AaveAdapter.json
      eventHandlers:
        - event: TokenVaultSet(indexed address,indexed address)
          handler: handleTokenVaultSet
        - event: Invested(indexed address,uint256,uint256)
          handler: handleInvested
        - event: Divested(indexed address,uint256,uint256)
          handler: handleDivested
      file: ./src/mappings/AaveAdapter.ts
  - kind: ethereum/contract
    name: UniswapV2Adapter
    network: localhost
    source:
      abi: UniswapV2Adapter
      address: "0xdbd296711ec8ef9aacb623ee3f1c0922dce0d7b2"
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - UniswapV2Adapter
        - UniswapV2TokenPosition
      abis:
        - name: UniswapV2Adapter
          file: ./abis/localhost_UniswapV2Adapter.json
      eventHandlers:
        - event: TokenConfigSet(indexed address,uint256,indexed address,indexed address)
          handler: handleTokenConfigSet
        - event: TokenConfigUpdated(indexed address,uint256)
          handler: handleTokenConfigUpdated
        - event: TokenConfigReinvested(indexed address,indexed address)
          handler: handleTokenConfigReinvested
        - event: UniswapInvested(indexed address,uint256,uint256,uint256)
          handler: handleUniswapInvested
        - event: UniswapDivested(indexed address,uint256,uint256,uint256)
          handler: handleUniswapDivested
      file: ./src/mappings/UniswapV2Adapter.ts
  - kind: ethereum/contract
    name: UniswapV3Adapter
    network: localhost
    source:
      abi: UniswapV3Adapter
      address: "0xdfd787c807dea8d7e53311b779bc0c6a4704d286"
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - UniswapV3Adapter
        - UniswapV3TokenPosition
      abis:
        - name: UniswapV3Adapter
          file: ./abis/localhost_UniswapV3Adapter.json
      eventHandlers:
        - event: TokenConfigSet(indexed address,uint256,indexed
            address,uint24,int24,int24,indexed address)
          handler: handleTokenConfigSet
        - event: TokenConfigUpdated(indexed address,uint256)
          handler: handleTokenConfigUpdated
        - event: TokenConfigReinvested(indexed address,indexed address,uint24,int24,int24)
          handler: handleTokenConfigReinvested
        - event: UniswapV3Invested(indexed address,uint256,uint256,uint256)
          handler: handleUniswapV3Invested
        - event: UniswapV3Divested(indexed address,uint256,uint256,uint256)
          handler: handleUniswapV3Divested
      file: ./src/mappings/UniswapV3Adapter.ts
templates:
  - kind: ethereum/contract
    name: VaultInstance
    network: localhost
    source:
      abi: VaultImplementation
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Vault
        - User
        - Deposit
        - Redeem
        - Allocation
        - UserVaultBalance
      abis:
        - name: VaultImplementation
          file: ./abis/localhost_VaultImplementation.json
        - name: IProtocolAdapter
          file: ./abis/IProtocolAdapter.json
      eventHandlers:
        - event: Deposit(uint256,indexed address,uint256)
          handler: handleDeposit
        - event: Redeem(uint256,indexed address,uint256)
          handler: handleRedeem
        - event: NoLongerActive()
          handler: handleNoLongerActive
        - event: HoldingAllocationUpdated((address,uint256)[])
          handler: handleHoldingAllocationUpdated
      file: ./src/mappings/VaultImplementation.ts
